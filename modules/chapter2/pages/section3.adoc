== Install and configure Istio with Service Mesh Operator

Kuadrant integrates with **https://istio.io/latest/docs/[Istio]** as a _Gateway API_ provider.

In this lab, you install and set up an https://istio.io/latest/docs/[Istio]-based Gateway API provider by using the Service Mesh Operator.

* Install Gateway API

. Switch to the terminal where you had taken access of bastion server. Before you can use Kuadrant, you need to install Gateway API v1 by applying the YAML file provided in the URL shown below:
+
[subs="+quotes,+macros"]
----
[lab-user@bastion ~]$ **oc apply -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.0.0/standard-install.yaml**
customresourcedefinition.apiextensions.k8s.io/gatewayclasses.gateway.networking.k8s.io created
customresourcedefinition.apiextensions.k8s.io/gateways.gateway.networking.k8s.io created
customresourcedefinition.apiextensions.k8s.io/httproutes.gateway.networking.k8s.io created
customresourcedefinition.apiextensions.k8s.io/referencegrants.gateway.networking.k8s.io created
----

. Create **gateway-system** namespace where the Gateway components shall be deployed:
+
[subs="+quotes,+macros"]
----
[lab-user@bastion ~]$ **oc create ns gateway-system**
namespace/gateway-system created
----

* Install Red Hat Openshift Service Mesh 3

. In your _Red Hat Openshift console_ , navigate to _Operators_ option. Select _OperatorHub_ option and type "service mesh" in the search box.
Select **Red Hat OpenShift Service Mesh 3** that appears in the search result, as shown in the image below:
+
image::service.png[align="center"]

. Confirm all the options are same as image below and select **Install** button:
+
image::service2.png[align="center"]

. Note that you can now see **Red Hat OpenShift Service Mesh 3 operator** in _Red Hat Openshift_ console's _Installed Operators_ section.
+
image::service3.png[align="center"]

* Configure Istio

. To configure the _Istio Gateway API_ provider, apply the yaml file from URL using below command:
+
[subs="+quotes,+macros"]
----
[lab-user@bastion ~]$ **oc apply -f https://raw.githubusercontent.com/RedHatQuickCourses/rhcl-qc-apps/refs/heads/main/istio-operator-config.yaml**
istio.operator.istio.io/default created
----

. Wait for Istio to be ready and confirm the **default** istio provider is available.
+
[subs="+quotes,+macros"]
----
[lab-user@bastion ~]$ **oc wait istio/default -n gateway-system --for="condition=Ready=true"**
istio.operator.istio.io/default condition met

[lab-user@bastion ~]$ **oc get istio -n gateway-system**
NAME      REVISIONS   READY   IN USE   ACTIVE REVISION   VERSION   AGE
default   1           1       0        Healthy           v1.23.0   34s
----
+
Once you notice the _condition met_ output for above command, proceed with next lab.
