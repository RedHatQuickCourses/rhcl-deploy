== Install Kuadrant on Red Hat OpenShift cluster

In this lab, you install and setup Kuadrant Operator and trigger Kuadrant deployment.

=== Install Kuadrant

. Create **kuadrant-system** namespace as shown below:
+
====
[source,subs="verbatim,quotes"]
----
**oc create ns kuadrant-system**
----
====
+
You should see output as follows:
+
[source,subs="verbatim,quotes"]
----
namespace/kuadrant-system created
----

. Setup **catalog source** for Kuadrant Operator by appling the yaml settings using below command:
+
====
[source,subs="verbatim,quotes"]
----
**oc apply -f -<<EOF
apiVersion: operators.coreos.com/v1alpha1
kind: CatalogSource
metadata:
  name: kuadrant-operator-catalog
  namespace: kuadrant-system
spec:
  sourceType: grpc
  image: quay.io/kuadrant/kuadrant-operator-catalog:v1.0.0-rc8
  displayName: Kuadrant Operators
  publisher: grpc
  updateStrategy:
    registryPoll:
      interval: 45m
EOF**
----
====
+
You should see output as follows:
+
[source,subs="verbatim,quotes"]
----
catalogsource.operators.coreos.com/kuadrant-operator-catalog created
----

. Install the **Kuadrant** operator by navigating to the Red Hat OpenShift cluster, select **OperatorHub** from side panel and search **Kuadrant**. 
Select the **Kuadrant Operator** highlighted in below screenshot and click **Install**
+
image::install1.png[align="center"]

* Select **kuadrant-system** namespace as shown in below screenshot and click **Install**.
+
image::new2.png[align="center"]

* Check the status of the installation using below command. When ready, the status will change from "installing" to "Complete."
+
====
[source,subs="verbatim,quotes"]
----
**oc get installplan -n kuadrant-system -o=jsonpath='{.items[0].status.phase}'**
----
====

* Observe the **Kuadrant** operator is installed along with it's dependencies in the _Red Hat Openshift_ console's  _Installed Operators_ section.
+
image::service4.png[align="center"]
+
** Below are the dependencies installed:
*** https://docs.kuadrant.io/latest/authorino-operator/#the-authorino-custom-resource-definition-crd[Authorino](Enforcement Component for AuthPolicy)
*** https://docs.kuadrant.io/latest/limitador-operator/#features[Limitador (Enforcement Component for RateLimitPolicy)]
*** DNS Operator (Enforcement Component for DNSPOlicy)

=== Deploy Kuadrant

* To trigger your Kuadrant deployment, execute the yaml settings using the following command:
+
====
[source,subs="verbatim,quotes"]
----
**oc apply -f -<<EOF
apiVersion: kuadrant.io/v1beta1
kind: Kuadrant
metadata:
  name: kuadrant
  namespace: kuadrant-system
EOF**
----
====
+
You should see the output as follows:
+
[source,subs="verbatim,quotes"]
----
kuadrant.kuadrant.io/kuadrant created
----

* Wait for Kuadrant to be ready as follows:
+
====
[source,subs="verbatim,quotes"]
----
**oc wait kuadrant/kuadrant --for="condition=Ready=true" -n kuadrant-system --timeout=300s**
----
====
+
You should see the output as follows:
+
[source,subs="verbatim,quotes"]
----
kuadrant.kuadrant.io/kuadrant condition met
----

* Enable Kuadrant plugin to view components configuration status easily that we would perform in coming sections.

. Navigate _Red Hat OpenShift cluster_ and from **Administrator** view, click  on **Home** -> **Overview**.
. Under **Status** section, click on **Dynamic Plugins** -> **View All**.
. You will see **kuadrant-console-plugin** marked  as disabled.
. Click on the pencil icon and then choose **Enabled** and click **Save**.
. Refresh the page in a couple of minutes, and you will see the Kuadrant menu on the left hand side menu.
+
image::kuad2.png[align="center"]

. Click on **Overview** option and you shall see a dashboard that will show you kuadrant's overview. You this dashboard to track status of **policies/gateways/http routes** that we shall configure in upcoming lab sections.
+
image::kuad3.png[align="center"]
